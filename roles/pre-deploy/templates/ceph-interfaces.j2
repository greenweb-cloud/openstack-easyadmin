{% set ip = ansible_default_ipv4.address.split('.')[-1] %}


auto lo
iface lo inet loopback

auto {{ interfaces[0] }}
iface {{ interfaces[0] }} inet manual
	mtu 9000

auto {{ interfaces[1] }}
iface {{ interfaces[1] }} inet manual
	mtu 9000

auto {{ interfaces[0] }}.{{ storage_vlanID }}
iface {{ interfaces[0] }}.{{ storage_vlanID }} inet manual
        vlan-raw-device {{ interfaces[0] }}

auto {{ interfaces[1] }}.{{ ceph_vlanID }}
iface {{ interfaces[1] }}.{{ ceph_vlanID }} inet manual
        vlan-raw-device {{ interfaces[1] }}


auto br-mgmt
iface br-mgmt inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports {{ interfaces[0] }}
    address {{ mgmt_NET }}.{{ ip }}/{{ mgmt_CIDR }}
    gateway {{ mgmt_GW }}

# Storage bridge
auto br-storage
iface br-storage inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports {{ interfaces[0] }}.{{ storage_vlanID }}
    address {{ storage_NET }}.{{ ip }}/{{ storage_CIDR }}


# Ceph Cluster OSD storage_ceph bridge
auto br-cluster
iface br-cluster inet static
    bridge_stp off
    bridge_waitport 0
    bridge_fd 0
    bridge_ports {{ interfaces[1] }}.{{ ceph_vlanID }}
    address {{ ceph_NET }}.{{ ip }}/{{ ceph_CIDR }}



